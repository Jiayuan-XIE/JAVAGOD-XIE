# 红黑树

## 1. 基础概念

### 1.1 是什么？

近似平衡的二叉查找树，或者说自平衡的二叉B树

是一种**特化的AVL数**，在插入和删除的时候通过**特定操作**保持二叉查找树的**相对平衡**

从而获得**较高的性能。**

- 相对平衡
- 性能高

牺牲小部分的查找效率，来降低更新树的代价。



### 1.2 为何引入

引入查找树，是为了提高查找速度，不平衡的查找树，速度可能会降到n（单链表）

但是一棵平衡二叉树，由于对平衡的要求太严格（左右高度相差不超过1）

导致插入节点的时候，要频繁的通过左旋和右旋来保持树的平衡，操作太频繁

**维护代价太高**

所以引入红黑树，介于两者之间，既能够保证树的高度不会太高，也能够使插入后的调整操作没有那么频繁。



### 1.3 特点

符合**二叉搜索树**的基本特性，同时具备一下特性：

1. 节点非黑即红
2. 根节点是黑色
3. 叶子节点也是黑色
4. 红色节点不相邻
5. 一个节点到叶子节点的路径上，包含的黑色节点个数相等（黑色平衡）

黑根黑叶红不邻，同祖等高只数黑





### 1.4 时间复杂度

**红黑树的时间复杂度为: O(logn)**



定理：**一棵含有n个节点的红黑树的高度至多为2log(n+1)**.



## 2.应用

红黑树的应用比较广泛，主要是用它来存储有序的数据，它的时间复杂度是O(lgn)，效率非常之高。
例如，Java集合中的[TreeSet](http://www.cnblogs.com/skywang12345/p/3311268.html)和[TreeMap](http://www.cnblogs.com/skywang12345/p/3310928.html)，HashMap以及Linux虚拟内存的管理，都是通过红黑树去实现的。



## 3. 基本操作

### 3.11 左旋

![image-20210813113024798](http://note.youdao.com/yws/public/resource/7d81e6a39024a96dd86efacf29f4ca80/xmlnote/WEBRESOURCE1140567adbab4e868146fb54589f81e3/2006)

**左旋中的“左”，意味着“被旋转的节点将变成一个左节点”**。

### 3.12 右旋

![image-20210813113048094](http://note.youdao.com/yws/public/resource/7d81e6a39024a96dd86efacf29f4ca80/xmlnote/WEBRESOURCEb963c3af4a7646a084e9373abc61fce0/2007)

其实就是左旋的镜像

**右旋中的“右”，意味着“被旋转的节点将变成一个右节点”**。

 

### 3.2 添加

**(1) 插入**

**将红黑树当作一颗二叉查找树，将节点插入。**



**(2) 着色**

**将插入的节点着色为"红色"。**

 为什么着色成红色，而不是黑色呢？为什么呢？在回答之前，我们需要重新温习一下红黑树的特性：
(1) 每个节点或者是黑色，或者是红色。
(2) 根节点是黑色。
(3) 每个叶子节点是黑色。 [注意：这里叶子节点，是指为空的叶子节点！]
(4) 如果一个节点是红色的，则它的子节点必须是黑色的。
(5) 从一个节点到该节点的子孙节点的所有路径上包含相同数目的黑节点。
    将插入的节点着色为红色，**不会违背"特性(5)"！少违背一条特性**，就意味着我们需要处理的情况越少。接下来，就要努力的让这棵树满足其它性质即可；满足了的话，它就又是一颗红黑树了。o(∩∩)o...哈哈



变为红色，并不会影响黑色平衡，会使得我们调整的操作少一些。



**(3) 通过一系列的旋转或着色等操作，使之重新成为一颗红黑树。**

​    第二步中，将插入节点着色为"红色"之后，不会违背"特性(5)"。那它到底会违背哪些特性呢？
​    对于"特性(1)"，显然不会违背了。因为我们已经将它涂成红色了。
​    对于"特性(2)"，显然也不会违背。在第一步中，我们是将红黑树当作二叉查找树，然后执行的插入操作。而根据二叉查找数的特点，插入操作不会改变根节点。所以，根节点仍然是黑色。
​    对于"特性(3)"，显然不会违背了。这里的叶子节点是指的空叶子节点，插入非空节点并不会对它们造成影响。
​    对于"特性(4)"，是有可能违背的！
​    那接下来，想办法使之"满足特性(4)"，就可以将树重新构造成红黑树了。



### 3.3 删除

**(1) 删除节点**

**将红黑树当作一颗二叉查找树，将节点删除。**



(2) **旋转和重新着色**

**通过"旋转和重新着色"等一系列来修正该树，使之重新成为一棵红黑树。**
因为"第一步"中删除节点之后，可能会违背红黑树的特性。所以需要通过"旋转和重新着色"来修正该树，使之重新成为一棵红黑树。

