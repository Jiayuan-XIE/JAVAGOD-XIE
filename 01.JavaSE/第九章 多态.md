# 第九章 多态

## 简介

顾名思义，多态，就是物质的多种形态。

多态提供了另一个维度的接口与实现分离，以解耦做什么和怎么做。多态不仅能改善代码的组织，提高代码的可读性，而且能创建有扩展性的程序



人类，有男人，有女人。

乐器，有吉他，钢琴，唢呐。

他们都可以弹奏同一个乐谱，但是具体用那个乐器，就是准备演奏时，看心情决定啦！（**后期绑定**）

> 多态是一项“将改变的事物与不变的事物分离”的重要技术。
>
> 改变意味着**可扩展**（新建子类），不变意味着调用**不变**（调用父类就行了）



面向对象三大特性：

- 封装
- 继承
- 多态

这次讲的就是第三大特性—**多态**（也称**动态绑定**或者**后期绑定**或者**运行时绑定**）



## 优点

### 可扩展，高复用

> 多态是一项“将改变的事物与不变的事物分离”的重要技术。
>
> 改变意味着**可扩展**（新建子类），不变意味着调用**不变**（调用父类就行了）



### 解耦

前面提到的**封装**，是通过将实现细节**私有化**使得接口与实现分离，从而达到解耦的作用。

而**多态**也有解耦，它是消除类型之间的耦合。



## 陷阱：重写私有方法

```java

package polymorphism;

public class PrivateOverride {
    private void f() {
        System.out.println("private f()");
    }

    public static void main(String[] args) {
        PrivateOverride po = new Derived();
        po.f();
    }
}

class Derived extends PrivateOverride {
    public void f() {
        System.out.println("public f()");
    }
}
```

输出：

```
private f()
```



注意：`PrivateOverride`的`f()`方法是私有的（**private** 方法也是隐式的 **final**），之前说过，被final限制的方法，不能被重写，所以子类`Derived`的`f()`方法并没有重写父类的方法， 而是一个新的方法，也就解释了这里执行的为什么是父类的方法，而不是子类的（因为父类有自己独立的方法可以被调用）。





## 通用准则

使用**继承**表达**行为**的差异，使用**属性**表达**状态**的变化。



## 转型

向上转型永远是安全的，因为父类不会比子类有更多的接口（一代更比一代强）。

相反，向下转型则很危险。

因为，孩子拥有的接口，父类未必有（Is-like-a），进而导致出错。





