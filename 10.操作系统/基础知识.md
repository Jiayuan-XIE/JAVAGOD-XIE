## 1. 进程与线程

### 1.1 进程

能够进行资源分配的基本单位。

**是正在运行的程序的一种抽象。**

官方定义：进程是进程实体的运行过程，是系统进行资源分配的基本单位。

#### 1）为何进入进程

- 为了能使程序**并发执行**
- 对其进行描述与控制



#### 2）基本状态

- 创建
- 就绪
- 执行
- 阻塞
- 终止



### 1.2 线程

线程是CPU调度的基本单位



#### 1）为何引入线程

进程太重了，创建调度的开销太大，故引入线程，轻装上阵。



### 1.3 进程与线程的区别

- 拥有资源：进程
- 独立调度：线程
- 并发性：线程高
- 系统开销：线程低
- 独立性：进程好

线程 = 进程 -  共享资源



线程优点：

- 更低的系统开销
- 更高的并发性
- 线程可共享资源

线程缺点：

- 稳定性差



## 2. 作业调度算法（与进程调度算法不同）

### 2.1 先来先服务

缺点：短作业可能要等很久。

### 2.2 短作业优先

缺点：

- 长作业一直得不到资源，可能会被饿死。
- 需要预知作业的运行时间。



### 2.3 优先级调度

赋予作业优先级，以反应作业的紧迫程度

优先权 = （等待时间+要求服务时间）/要求服务时间。

有利于短作业执行，又不会让长作业一直等下去。



## 3. 进程调度算法

### 3.1 先来先服务

从就绪的进程队列里选一个最先进入队列的进程。



### 3.2 时间片轮转

一个采用FCFS策略的进程就绪队列，时间片用完就中断，将CPU分配给下一个进程。



**时间片大小的确定：**

不能太大，也不能太小。

- **太大**：轮转算法就退化为了FCFS算法

- **太小**：频繁切换，导致系统开销增大

合适大小：**略大于一次典型的交互时间**



### 3.3 优先级调度

- 静态优先级
- 动态优先级（可以根据等待时间，增大优先级）

### 3.4 多队列调度

更加灵活，把一个就绪队列拆成了多个，不同的就绪队列可以采用不同的调度算法。（FCFS、优先级、静态优先级、动态优先级）



### 3.5 多级反馈队列

一个大进程需要执行 100 个时间片，如果采用时间片轮转调度算法，那么需要交换 100 次。

对需要**连续执行多个时间片**的进程考虑的，它设置的了多个队列，每个队列所被赋予的时间片大小不同：1、2、4、8

如果一个进程在当前队列没有执行完，就会移交到下一个队列，拥有更大的时间片，直到运行完成。

每个队列内部是FCFS的。



## 4. 上下文切换

操作系统实现线程或者进程**交错执行**的机制，称为上下文切换。

是指内核在CPU上对线程或进程进行切换。

在此过程中，信息被保存在PCB进程控制块中，直到到再次被使用



### 4.1切换的原因

1. 当前任务执行完成
2. 当前任务阻塞
3. 被抢占，没有抢到锁资源
4. 用户的代码主动挂起，如yield()，让出CPU
5. 硬件中断

